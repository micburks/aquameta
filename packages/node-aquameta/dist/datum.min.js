!function(t){function e(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var n={};return e.m=t,e.c=n,e.i=function(t){return t},e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=8)}([function(t,e,n){"use strict";var r=function(t,e,n){this.row=t,this.column=new AQ.Column(t.relation,e),this.is_primary_key=n,this.name=e,this.value=t.get(e),this.id={row_id:this.row.id,column_id:this.column.id},this.to_url=function(t){if(null==this.row.pk_value)throw console.error('You must call a row with "meta_data: true" in order to use the to_url function'),"Datum.js: Programming Error";return t?"/field/"+this.row.relation.schema.name+"/"+this.row.relation.name+"/"+this.row.pk_value+"/"+this.column.name:this.row.relation.schema.database.endpoint.url+"/field/"+this.row.relation.schema.name+"/"+this.row.relation.name+"/"+this.row.pk_value+"/"+this.column.name}};r.prototype={get:function(){return this.row.get(this.name)},set:function(t){return this.value=t,this.row.set(this.name,t)},update:function(){return this.row.update()}},t.exports=r},function(t,e,n){"use strict";var r=n(3);t.exports=function(){var t={url:"/endpoint/",version:"/v1/"},e=function(e){return function(n,o,i){var s=new r(o),a=("/"+t.url+"/"+t.version).replace(/\/\//g,"/");console.log(a);var u=n.toUrl(),h=a+u,l=h+s.queryString;"GET"===e&&(location.host+l).length>1e3&&(e="POST");var c=new Headers;c.append("Content-Type","application/json");var m={method:e,headers:c,credentials:"same-origin"};return"GET"!==e&&(m.body=JSON.stringify(i)),fetch("GET"===e?l:h,m).then(function(t){if("undefined"==typeof t.json)return t;var e=t.json();return t.status>=200&&t.status<300?e:e.then(Promise.reject.bind(Promise))}).catch(function(t){throw console.groupCollapsed(e,t.statusCode,t.title),"message"in t&&console.error(t.message),console.groupEnd(),t.title})}};return{get:e("GET"),post:e("POST"),patch:e("PATCH"),delete:e("DELETE")}}()},function(t,e,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o=n(5),i=n(4),s=function(t,e){this.endpoint=t,this.name=e,this.id={name:this.name}};s.prototype.relation=function(t){return new o(this,t)},s.prototype.function=function(t,e,n){if("object"==("undefined"==typeof t?"undefined":r(t)))var o=t.name,s=t.parameters;else var o=t;n=n||{},n.args={},"undefined"!=typeof e&&(!(e instanceof Array)&&e instanceof Object?n.args.kwargs=e:(e instanceof Array||(e=[e]),n.args.vals=e));var a=new i(this,o,s);return this.database.endpoint.get(a,n).then(function(t){if(!t)throw"Empty response";if(!t.result.length)throw"Result set empty";return t.result.length>1?new FnResultSet(a,t):new FnResult(a,t)}.bind(this)).catch(function(t){throw"Function call request failed: "+t})},t.exports=s},function(t,e,n){"use strict";var r=function(t){var e=this;t=t||{},t.metaData=!t.hasOwnProperty("metaData")||t.metaData,this.queryString=Object.keys(t).sort().map(function(n){e[n]=t[n];var r=t[n];switch(n){case"where":return r=r.length?r:[r],r.map(function(t){return"where="+encodeURIComponent(JSON.stringify(t))}).join("&");case"order_by":return r=r.length?r:[r],n+"="+encodeURIComponent(r.map(function(t,e){return("asc"!==t.direction?"-":"")+t.column}).join(","));case"limit":case"offset":var o=parseInt(r);if(!isNaN(o))return n+"="+o;return;case"evented":return"session_id="+encodeURIComponent(JSON.stringify(r));case"metaData":case"args":case"exclude":case"include":return n+"="+encodeURIComponent(JSON.stringify(r))}}).join("&").replace(/^/,"?").replace(/&&/g,"&"),console.log(this)};t.exports=r},function(t,e,n){"use strict";var r=function(t,e,n){this.schema=t,this.name=e,n instanceof Array?this.args="{"+n.join(",")+"}":this.args=n,this.id={schema_id:this.schema.id,name:this.name,args:this.args},this.to_url=function(t){var e=t?"":this.schema.database.endpoint.url;return"undefined"!=typeof this.args?e+"/function/"+this.schema.name+"/"+this.name+"/"+this.args:e+"/function/"+this.schema.name+"/"+this.name}};t.exports=r},function(t,e,n){"use strict";var r=n(7),o=n(6),i=function(t,e){this.schema=t,this.name=e,this.id={schema_id:this.schema.id,name:this.name}};i.prototype.toUrl=function(){return"/"+this.schema.name+"/"+this.name+"/"},i.prototype.column=function(t){return new AQ.Column(this,t)},i.prototype.rows=function(t){var e=this;this.schema.endpoint.get(this,t).then(function(t){return new r(e,t)})},i.prototype.row=function(t){var e=this;this.schema.endpoint.get(this,t).then(function(t){return new o(e,t)})},i.prototype.insert=function(t,e){return this.schema.endpoint.post(this,e)},t.exports=i},function(t,e,n){"use strict";var r=(n(0),function(t,e){this.relation=t,this.schema=t.schema,this.row_data=response.result[0].row,this.cached_fields={},this.columns=response.columns||null,this.pk_column_name=null,this.pk_value=null,this.id=null,this.to_url=function(){throw console.error('You must call a row with "meta_data: true" in order to use the to_url function'),"Datum.js: Programming Error"},"undefined"!=typeof response.pk&&(this.pk_column_name=response.pk,this.pk_value=this.get(this.pk_column_name),this.id={pk_column_id:{relation_id:this.relation.id,name:this.pk_column_name},pk_value:this.pk_value},this.to_url=function(t){return t?"/row/"+this.relation.schema.name+"/"+this.relation.name+"/"+this.pk_value:this.relation.schema.database.endpoint.url+"/row/"+this.relation.schema.name+"/"+this.relation.name+"/"+this.pk_value})});r.prototype={constructor:r,get:function(t){return this.row_data[t]},set:function(t,e){return this.row_data[t]=e,this},toString:function(){return JSON.stringify(this.row_data)},clone:function(){return new AQ.Row(this.relation,{columns:this.columns,pk:this.pk_column_name,result:[{row:this.row_data}]})},field:function(t){return"undefined"==typeof this.cached_fields[t]&&(this.cached_fields[t]=new AQ.Field(this,t,t===this.pk_column_name)),this.cached_fields[t]},fields:function(){return null!=this.columns?this.columns.map(function(t){return this.field(t.name)}.bind(this)):null}},r.prototype.update=function(){return this.relation.schema.database.endpoint.patch(this,this.row_data).then(function(t){if(null==t)throw"Empty response";return this}.bind(this)).catch(function(t){throw"Update failed: "+t})},r.prototype.delete=function(){return this.relation.schema.database.endpoint.delete(this).then(function(t){if(null==t)throw"Empty response"}).catch(function(t){throw"Delete failed: "+t})},r.prototype.relatedRows=function(t,e,n,r){var o=e.split(".");o.length<2&&console.error("Related relation name must be schema qualified (schema_name.relation_name)");var i=o[0],s=o[1],a=this.relation.schema.database;return r=r||{},r.where=r.where instanceof Array?r.where:"undefined"==typeof r.where?[]:[r.where],r.where.push({name:n,op:"=",value:this.get(t)}),a.schema(i).relation(s).rows(r)},r.prototype.relatedRow=function(t,e,n,r){var o=e.split(".");o.length<2&&console.error("Related relation name must be schema qualified (schema_name.relation_name)");var i=o[0],s=o[1],a=this.relation.schema.database;return r=r||{},r.where=r.where instanceof Array?r.where:"undefined"==typeof r.where?[]:[r.where],r.where.push({name:n,op:"=",value:this.get(t)}),a.schema(i).relation(s).row(r)},t.exports=r},function(t,e,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o=(n(0),function(t,e,n){this.relation=t,this.schema=t.schema,this.columns=e.columns||null,this.pk_column_name=e.pk||null,this.rows=e.result,this.length=e.result.length,this.server_arguments=n||{}});o.prototype.update=function(){},o.prototype.delete=function(){},o.prototype.map=function(t){return this.rows.map(function(t){return new Row(this.relation,{columns:this.columns,pk:this.pk_column_name,result:[t]})}.bind(this)).map(t)},o.prototype.forEach=function(t){return this.rows.map(function(t){return new Row(this.relation,{columns:this.columns,pk:this.pk_column_name,result:[t]})}.bind(this)).forEach(t)},o.prototype.reload=function(){return this.relation.rows(this.server_arguments)},o.prototype.where=function(){var t=!1,e=!0,n={};if("object"==r(arguments[0])){n=arguments[0];var o=n.field,i=n.value;arguments.length>1&&(t=arguments[1]),arguments.length>2&&(e=arguments[2])}else if("string"==typeof arguments[0]&&arguments.length>1){var o=arguments[0],i=arguments[1];arguments.length>2&&(t=arguments[2]),arguments.length>3&&(e=arguments[3])}return new Promise(function(e,n){if(t){for(var r=0;r<this.rows.length;r++)this.rows[r].row[o]==i&&e(new AQ.Row(this.relation,{columns:this.columns,result:[this.rows[r]]}));n("could not find "+o+" "+i)}else{for(var s=[],r=0;r<this.rows.length;r++)this.rows[r].row[o]==i&&s.push(this.rows[r]);e(new AQ.Rowset(this.relation,{columns:this.columns,result:s}))}if(1==new_rowset.length)return new AQ.Row(this.relation,new_rowset);if(new_rowset.length>1)throw"Multiple Rows Returned";return null}.bind(this))},o.prototype.orderBy=function(t,e){return"asc"!==e&&ordered.reverse(),new AQ.Rowset(this.relation,{columns:this.columns,result:ordered})},o.prototype.limit=function(t){if(t<=0)throw"Bad limit";return new AQ.Rowset(this.relation,{columns:this.columns,result:this.rows.slice(0,t)})},o.prototype.relatedRows=function(t,e,n,r){var o=e.split(".");o.length<2&&console.error("Related relation name must be schema qualified (schema_name.relation_name)");var i=o[0],s=o[1],a=this.relation.schema.database,u=this.map(function(e){return e.get(t)});return r=r||{},r.where=r.where instanceof Array?r.where:"undefined"==typeof r.where?[]:[r.where],r.where.push({name:n,op:"in",value:u}),a.schema(i).relation(s).rows(r)},o.prototype.relatedRow=function(t,e,n,r){var o=e.split(".");o.length<2&&console.error("Related relation name must be schema qualified (schema_name.relation_name)");var i=o[0],s=o[1],a=this.relation.schema.database,u=this.map(function(e){return e.get(t)});return r=r||{},r.where=r.where instanceof Array?r.where:"undefined"==typeof r.where?[]:[r.where],r.where.push({name:n,op:"in",value:u}),a.schema(i).relation(s).row(r)},t.exports=o},function(t,e,n){"use strict";n(1),n(2)}]);